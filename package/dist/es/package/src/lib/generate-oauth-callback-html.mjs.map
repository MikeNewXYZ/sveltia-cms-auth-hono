{"version":3,"file":"generate-oauth-callback-html.mjs","sources":["../../../../../src/lib/generate-oauth-callback-html.ts"],"sourcesContent":["import type { Context } from \"hono\";\nimport { deleteCookie } from \"hono/cookie\";\n\nexport type GenerateOAuthCallbackHTMLProps = {\n\tc: Context;\n\tprovider?: string;\n\ttoken: string;\n};\n\n// Creates HTML page with JS that communicates with opener window to pass auth data\nexport const generateOAuthCallbackHTML = ({\n\tc,\n\tprovider = \"unknown\",\n\ttoken,\n}: GenerateOAuthCallbackHTMLProps) => {\n\tconst jsonContent = JSON.stringify({ provider, token });\n\n\tdeleteCookie(c, \"auth_state\");\n\tdeleteCookie(c, \"provider\");\n\n\treturn c.html(/*html*/ `\n    <!doctype html><html><body><script>\n    (() => {\n      window.addEventListener('message', ({ data, origin }) => {\n      if (data === 'authorizing:${provider}') {\n        window.opener?.postMessage(\n        'authorization:${provider}:success:${jsonContent}',\n        origin\n        );\n      }\n      });\n      window.opener?.postMessage('authorizing:${provider}', '*');\n    })();\n    </script></body></html>\n  `);\n};\n"],"names":["generateOAuthCallbackHTML","c","provider","token","jsonContent","deleteCookie"],"mappings":";AAUO,MAAMA,IAA4B,CAAC;AAAA,EACzC,GAAAC;AAAA,EACA,UAAAC,IAAW;AAAA,EACX,OAAAC;AACD,MAAsC;AACrC,QAAMC,IAAc,KAAK,UAAU,EAAE,UAAAF,GAAU,OAAAC,GAAO;AAEtD,SAAAE,EAAaJ,GAAG,YAAY,GAC5BI,EAAaJ,GAAG,UAAU,GAEnBA,EAAE;AAAA;AAAA,IAAc;AAAA;AAAA;AAAA;AAAA,kCAIUC,CAAQ;AAAA;AAAA,yBAEjBA,CAAQ,YAAYE,CAAW;AAAA;AAAA;AAAA;AAAA;AAAA,gDAKRF,CAAQ;AAAA;AAAA;AAAA;AAAA,EAGrD;AACH;"}