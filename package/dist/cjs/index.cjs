"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const q=require("hono"),u=require("./node_modules/.pnpm/hono@4.7.4/node_modules/hono/dist/helper/cookie/index.cjs");require("./node_modules/.pnpm/arctic@3.5.0/node_modules/arctic/dist/client.cjs");require("./node_modules/.pnpm/@oslojs_encoding@0.4.1/node_modules/@oslojs/encoding/dist/base32.cjs");require("./node_modules/.pnpm/@oslojs_encoding@0.4.1/node_modules/@oslojs/encoding/dist/base64.cjs");require("./node_modules/.pnpm/@oslojs_encoding@1.1.0/node_modules/@oslojs/encoding/dist/base32.cjs");require("./node_modules/.pnpm/@oslojs_encoding@1.1.0/node_modules/@oslojs/encoding/dist/base64.cjs");const k=require("./node_modules/.pnpm/arctic@3.5.0/node_modules/arctic/dist/oauth2.cjs"),b=require("./node_modules/.pnpm/arctic@3.5.0/node_modules/arctic/dist/providers/github.cjs"),g=require("./package/src/validators/auth-validator.cjs"),s=require("./package/src/validators/callback-validator.cjs"),v=require("./package/src/lib/generate-oauth-callback-html.cjs"),l={path:"/",httpOnly:!0,secure:!0,maxAge:10*60,sameSite:"Lax"},A=({provider:d,options:h})=>{const{github:n}=d,{allowedDomains:p}=h??{},t=new q.Hono,c=new b.GitHub(n.clientId,n.clientSecret,null);return t.get("/auth",g.authQueryValidator(p),e=>{const{provider:r,scope:o}=e.req.valid("query"),a=k.generateState(),i=c.createAuthorizationURL(a,o.split(","));return u.setCookie(e,"auth_state",a,l),u.setCookie(e,"provider",r,l),e.redirect(i.href)}),t.get("/callback",s.callbackQueryValidator,s.callbackCookieValidator,async e=>{const{code:r}=e.req.valid("query"),{provider:o}=e.req.valid("cookie"),i=(await c.validateAuthorizationCode(r)).accessToken();return v.generateOAuthCallbackHTML({c:e,provider:o,token:i})}),t};exports.createAuthApp=A;
//# sourceMappingURL=index.cjs.map
