"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const s=require("../../../node_modules/.pnpm/zod@3.24.2/node_modules/zod/lib/index.cjs"),i=require("../../../node_modules/.pnpm/@hono_zod-validator@0.4.3_hono@4.7.4_zod@3.24.2/node_modules/@hono/zod-validator/dist/index.cjs"),u=(r,e)=>e.split(",").map(t=>t.trim()).some(t=>{const n=`^${t.replace(/[.+?^${}()|[\]\\]/g,"\\$&").replace(/\*/g,".*")}$`;return new RegExp(n).test(r)}),o=s.default.object({provider:s.default.enum(["github"],{message:"The selected backend is not supported."}),site_id:s.default.string(),scope:s.default.string()}),c=r=>i.zValidator("query",o,(e,a)=>{if(!e.success)return a.text(e.error.issues[0].message,{status:422});const t=e.data.site_id;if(r&&!u(t,r))return a.text("Your domain is not authorized to use this authenticator.",{status:403})});exports.authQueryValidator=c;
//# sourceMappingURL=auth-validator.cjs.map
