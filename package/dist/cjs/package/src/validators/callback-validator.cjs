"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const o=require("../../../node_modules/.pnpm/hono@4.7.4/node_modules/hono/dist/helper/cookie/index.cjs"),t=require("../../../node_modules/.pnpm/zod@3.24.2/node_modules/zod/lib/index.cjs"),s=require("../../../node_modules/.pnpm/@hono_zod-validator@0.4.3_hono@4.7.4_zod@3.24.2/node_modules/@hono/zod-validator/dist/index.cjs"),r=t.default.object({code:t.default.string({message:"Missing code query."}),state:t.default.string({message:"Missing state query."})}),c=t.default.object({auth_state:t.default.string({message:"Missing cookie state cookie."}),provider:t.default.string({message:"Missing provider information cookie."})}),u=s.zValidator("query",r,(e,a)=>{const i=o.getCookie(a,"auth_state");if(e.data.state!==i)return a.text("A security issue was detected (CSRF attack). Please restart the authentication process and try again.",{status:403});if(!e.success)return a.text(e.error.issues[0].message,{status:422})}),n=s.zValidator("cookie",c,(e,a)=>{if(!e.success)return a.text(e.error.issues[0].message,{status:422})});exports.callbackCookieValidator=n;exports.callbackQueryValidator=u;
//# sourceMappingURL=callback-validator.cjs.map
